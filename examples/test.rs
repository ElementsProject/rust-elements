extern crate elements;

use elements::BlockHeader;
use elements::encode::deserialize;
use elements::bitcoin_hashes::hex::FromHex;


#[cfg(feature = "serde-feature")]
fn main() {
    let header = block_header_liquid();
    let vec = serde_cbor::to_vec(&header).unwrap();
    let back: BlockHeader = serde_cbor::from_slice(&vec).unwrap();
    assert_eq!(header, back);

    let header = block_header_dynafed();
    let vec = serde_json::to_vec(&header).unwrap();
    let back: BlockHeader = serde_json::from_slice(&vec).unwrap();
    assert_eq!(header, back);

    let header = block_header_dynafed();
    let vec = serde_cbor::to_vec(&header).unwrap();
    let back: BlockHeader = serde_cbor::from_slice(&vec).unwrap();
    assert_eq!(header, back);
}

#[cfg(not(feature = "serde-feature"))]
fn main() {
    println!("use with serde-feature");
}

fn block_header_dynafed() -> BlockHeader {
    deserialize( &Vec::<u8>::from_hex(
        "000000a013d3fd2bf9e58616f0a283ea6f8d4674bf071f01eb7c1b5916c6168cf048dc1a5123137f8e22e2ef372734506a22adc8769e2dee5da60f5cd0b69e074c0f6dff1c7b855f67000000012200204ae81572f06e1b88fd5ced7a1a000945432e83e1551e6f721ee9c00b8cc332604a000000fbee9cea00d8efdc49cfbec328537e0d7032194de6ebf3cf42e5c05bb89a08b100010151"
    ).unwrap()).unwrap()
}

fn block_header_liquid() -> BlockHeader {
    deserialize( &Vec::<u8>::from_hex(
        "00000020890422eacb856b589f2e7dfde6de948fa792c17104341ba05fe626cba792e5e8e567a787e6c677942bc611080773ceacb83e41d25ddcbbf0ccccf9d59067e794ef75855fa9af0f00fd01025b21026a2a106ec32c8a1e8052e5d02a7b0a150423dbd9b116fc48d46630ff6e6a05b92102791646a8b49c2740352b4495c118d876347bf47d0551c01c4332fdc2df526f1a2102888bda53a424466b0451627df22090143bbf7c060e9eacb1e38426f6b07f2ae12102aee8967150dee220f613de3b239320355a498808084a93eaf39a34dcd62024852102d46e9259d0a0bb2bcbc461a3e68f34adca27b8d08fbe985853992b4b104e27412102e9944e35e5750ab621e098145b8e6cf373c273b7c04747d1aa020be0af40ccd62102f9a9d4b10a6d6c56d8c955c547330c589bb45e774551d46d415e51cd9ad5116321033b421566c124dfde4db9defe4084b7aa4e7f36744758d92806b8f72c2e943309210353dcc6b4cf6ad28aceb7f7b2db92a4bf07ac42d357adf756f3eca790664314b621037f55980af0455e4fb55aad9b85a55068bb6dc4740ea87276dc693f4598db45fa210384001daa88dabd23db878dbb1ce5b4c2a5fa72c3113e3514bf602325d0c37b8e21039056d089f2fe72dbc0a14780b4635b0dc8a1b40b7a59106325dd1bc45cc70493210397ab8ea7b0bf85bc7fc56bb27bf85e75502e94e76a6781c409f3f2ec3d1122192103b00e3b5b77884bf3cae204c4b4eac003601da75f96982ffcb3dcb29c5ee419b92103c1f3c0874cfe34b8131af34699589aacec4093399739ae352e8a46f80a6f68375faefd13030046304402206d95c5cc2d5b4203eb538b097a935436d303a6851ad94fd854f247a7a4c67361022074b90e0d81e76ee6b247620a58eb3d4b9841f3eaf9cc126236ccd65ff153086e46304402206a2335ede5d6224e6eafe581e93fe1a2bd65530edb0c102df5b46501fff7096a02201f6578569dcd7b73acfa247111121b1a90de048501268f0adb3214b204d7b4d246304402205dcb7881a03227477c327990c0c4d90fff0b3284e5c3e7af87f4aa4abafc855e02200eb7cf1730f1fcafe0974a38fabeabeea690cea2695d75a86a9af2b85723c561473045022100ce6acc19171dbe1bf827899d54e16e23198c982b9fc6bf1956ed030d825572ae022019f5a5aacc222f8d06c8151b5c44df21ab9182952960bdb7558efad0667ccc0b473045022100e4f01155a8346a2f15c4b4029a751e26eddc36feff3a5b1e0fdbaf245f3750410220247a2ed30ad02c7fcefdedda7e66da161143425962cac0e0ab7d76a243882c8e46304402206923d3c132ca586fba2d6fecc0f43d9c9e04955e2aaef0c847e3421b67c2015902207b06e133c31fbed4eb1b1b3b8c2ebcf304838c1908ea7fac2a3c7fb427e500ef4730450221008df836dedf4c952c06fcabc7509af1f13608cdf37196f30607dd14c50b6ee077022076bfd0c9ed4d20a85aa0359e5ec8f2c00bf0eccdd1e3b57084fd382ce7eca10846304402200b4fd27da82d856ee916e168f4f8c73a361cb245c9ff9ddc5d82880bafc7ea3e022049f6fb32a2d94574085eae738209ec1a1472c3cf4fd521c719a47e7293a522a2473045022100ce4472e20db34da9275ba998e5b3e76cf1533941da637630bd9cc0c20804846702205ddeccec1b31a73ac6ee59371d046e4c4d4fcb09e611ac1368fd8a3f23cabebb4630440220289806cdd9c1e3e62644845557979dba23623aac8a1f5c8862d507c409c6ae01022068827d69af84ff04d9691a8c717900a44d0ea4afd5665b2063273a2dbd4478c9473045022100bc47af1182eb26d9cc6a975011740c4646ffa9b3493babbd510fe8972ef73e7102206c8b2551be21bdd65b39d56624468217d9de5e008b876edbf5910b9d8210c151"
    ).unwrap()).unwrap()
}